

cc_library_shared {
    name: "camera.sdm660",
    compile_multilib: "32",
    cflags: [
        "-Wall",
        "-Wextra",
        "-Werror",
        "-DFDLEAK_FLAG",
        "-DVANILLA_HAL",
        "-DMEMLEAK_FLAG",
        "-Wno-compound-token-split-by-macro",
        "-DQCAMERA_HAL3_SUPPORT",
        "-DSYSTEM_HEADER_PREFIX=sys",
        "-DHAS_MULTIMEDIA_HINTS",
        "-D_ANDROID",
        "-DUSE_HAL_3_5",
        "-DUSE_MEDIA_EXTENSIONS",
        "-DUSE_DISPLAY_SERVICE",
        "-std=c++14",
        "-std=gnu++1z",
        "-DUSE_VENDOR_PROP",
        "-DDEFAULT_DENOISE_MODE_ON",
        "-DHAL3",
        "-DQCAMERA_REDEFINE_LOG",
        "-DUBWC_PRESENT",
        "-DVENUS_PRESENT",
        "-DUSE_CAMERA_METABUFFER_UTILS",
        "-DVIDEO_EXPLICIT_UBWC",
        "-DSUPPORT_ONLY_HAL3",
        "-DSUPPORT_POWER_HINT_XML",
    ],
    include_dirs: [
        "device/xiaomi/platina/camera/mm-image-codec/qexif",
        "device/xiaomi/platina/camera/mm-image-codec/qomx_core",
        "hardware/qcom-caf/sdm660/media/libstagefrighthw",
        "hardware/qcom-caf/sdm660/media/mm-core/inc",
        "system/memory/libion/kernel-headers",
        "system/memory/libion/include",
        "hardware/qcom-caf/sdm660/display/libqservice",
    ],
    local_include_dirs: [
        "stack/mm-camera-interface/inc",
        "util",
        "HAL3",
        "HAL",
        "HAL/tsMakeuplib/include",
    ],
    header_libs: [
        "media_plugin_headers",
        "camera_common_headers",
        "display_headers",
        "camera_fdleak_headers",
        "libandroid_sensor_headers",
        "libcutils_headers",
        "libsystem_headers",
        "libhardware_headers",
        "generated_kernel_headers",
    ],
    ldflags: [
        "-Wl,--wrap=open",
        "-Wl,--wrap=close",
        "-Wl,--wrap=socket",
        "-Wl,--wrap=pipe",
        "-Wl,--wrap=mmap",
        "-Wl,--wrap=__open_2",
        "-Wl,--wrap=malloc",
        "-Wl,--wrap=free",
        "-Wl,--wrap=realloc",
        "-Wl,--wrap=calloc",
    ],

    relative_install_path: "hw",

    shared_libs: [
        "liblog",
        "libhardware",
        "libutils",
        "libcutils",
        "libdl",
        "libsync",
        "libmmcamera_interface",
        "libmmjpeg_interface",
        "libui",
        "libcamera_metadata",
        "libqdMetaData",
        "libqservice",
        "libbinder",
        "libcutils",
        "libdl",
        "libhal_dbg",
        "libion",
        "android.frameworks.displayservice@1.0",
        "android.hidl.base@1.0",
        "libhidlbase",
    ],
    srcs: [
        "util/QCameraBufferMaps.cpp",
        "util/QCameraCmdThread.cpp",
        "util/QCameraFlash.cpp",
        "util/QCameraPerf.cpp",
        "util/QCameraQueue.cpp",
        "util/QCameraDisplay.cpp",
        "util/QCameraCommon.cpp",
        "util/QCameraTrace.cpp",
        "util/camscope_packet_type.cpp",
        "util/QCameraPerfTranslator.cpp",
        "QCamera2Hal.cpp",
        "QCamera2Factory.cpp",
        "HAL3/QCamera3HWI.cpp",
        "HAL3/QCamera3Mem.cpp",
        "HAL3/QCamera3Stream.cpp",
        "HAL3/QCamera3Channel.cpp",
        "HAL3/QCamera3VendorTags.cpp",
        "HAL3/QCamera3PostProc.cpp",
        "HAL3/QCamera3CropRegionMapper.cpp",
        "HAL3/QCamera3StreamMem.cpp",
        "HAL/QCameraMem.cpp",
        "HAL/QCameraThermalAdapter.cpp",
        "util/QCameraFOVControl.cpp",
        "util/QCameraHALPP.cpp",
        "util/QCameraDualFOVPP.cpp",
        "util/QCameraExtZoomTranslator.cpp",
        "util/QCameraPprocManager.cpp",
        "util/QCameraBokeh.cpp",
        "util/QCameraClearSight.cpp",
    ],
    static_libs: ["android.hardware.camera.common@1.0-helper"],

    vendor: true,
}

cc_library_headers {
    name: "camera_common_headers",
    installable: false,
    export_include_dirs: ["stack/common"],

}

cc_library_headers {
    name: "camera_fdleak_headers",
    installable: false,
    export_include_dirs: ["stack/common/leak"],

}
